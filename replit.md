# نظام إدارة المشاريع الإنشائية باللغة العربية

## نظرة عامة
نظام شامل لإدارة المشاريع الإنشائية مصمم خصيصاً للشرق الأوسط بواجهة عربية كاملة. يقدم أدوات إدارة مالية متقدمة مع تتبع دقيق للبيانات، مع التركيز على التصميم المتجاوب والواجهات الصديقة للهاتف المحمول.

## التقنيات المستخدمة
- **Frontend**: React.js مع TypeScript
- **Backend**: Express.js مع TypeScript
- **Database**: Supabase PostgreSQL
- **Styling**: Tailwind CSS مع shadcn/ui
- **State Management**: React Query (@tanstack/react-query)
- **Routing**: Wouter
- **Forms**: React Hook Form مع Zod validation
- **ORM**: Drizzle ORM
- **Export**: ExcelJS و jsPDF
- **Build Tool**: Vite

## البنية المعمارية

### قاعدة البيانات
- **Supabase PostgreSQL**: قاعدة البيانات السحابية الوحيدة المستخدمة
- **الجداول الرئيسية**:
  - `users`: المستخدمين
  - `projects`: المشاريع
  - `workers`: العمال
  - `worker_attendance`: حضور العمال
  - `fund_transfers`: تحويلات العهدة
  - `material_purchases`: مشتريات المواد
  - `transportation_expenses`: مصاريف النقل
  - `worker_transfers`: حوالات العمال
  - `suppliers`: الموردين
  - `supplier_payments`: مدفوعات الموردين

### الواجهة الأمامية
- **التوجه**: RTL (من اليمين لليسار) للدعم الكامل للعربية
- **التنقل**: Bottom Navigation مع Floating Add Button
- **الصفحات الرئيسية**:
  - Dashboard: لوحة التحكم الرئيسية
  - Projects: إدارة المشاريع
  - Workers: إدارة العمال
  - Worker Attendance: حضور العمال
  - Daily Expenses: المصاريف اليومية
  - Material Purchase: مشتريات المواد
  - Reports: التقارير

### الخادم الخلفي
- **API Routes**: RESTful APIs مع validation
- **Authentication**: Express sessions
- **File Structure**:
  - `server/index.ts`: نقطة دخول الخادم
  - `server/routes.ts`: API endpoints
  - `server/storage.ts`: طبقة الوصول للبيانات
  - `server/db.ts`: إعداد قاعدة البيانات

## الميزات الحالية

### إدارة المشاريع
- إنشاء وتعديل وحذف المشاريع
- تتبع حالة المشروع (نشط، مكتمل، متوقف)
- إحصائيات مالية شاملة لكل مشروع

### إدارة العمال
- تسجيل العمال مع أنواعهم (معلم، عامل)
- تتبع الأجور اليومية
- نظام حضور متقدم
- إدارة حوالات الأهل

### الإدارة المالية
- تحويلات العهدة بأنواعها المختلفة
- تتبع المصاريف اليومية
- مشتريات المواد والأدوات
- مصاريف النقل
- إدارة حسابات الموردين

### التقارير والتصدير
- تقارير مالية شاملة
- تصدير البيانات إلى Excel
- طباعة التقارير كـ PDF

## تفضيلات المستخدم
- **اللغة**: العربية في جميع الردود والملاحظات (تم التحديث: 19 أغسطس 2025)
- **التوجه**: RTL support كامل
- **التصميم**: Material Design مع ألوان مناسبة للثقافة العربية
- **التواصل**: استخدام اللغة العربية في جميع التفاعلات والتوجيهات

## التغييرات الأخيرة  
- **تاريخ**: 19 أغسطس 2025
- **الحالة**: ✅ تم حل مشكلة عرض البيانات في الواجهة بالكامل - التطبيق يعمل مثالياً
- **المنجز في التحديث الأخير**:
  - ✅ **حل مشكلة عرض البيانات الحرجة**:
    - اكتشاف وإصلاح خطأ في ترتيب parameters في دالة apiRequest
    - تصحيح جميع استدعاءات API لتعمل بالشكل الصحيح  
    - التأكد من عمل React Query وعرض البيانات في الواجهة
  - ✅ **تحسين أداء Frontend**:
    - إصلاح استدعاءات تحويلات العهدة وحضور العمال 
    - تحسين إعدادات staleTime وgcTime لـ React Query
    - إزالة logs التشخيصية وتنظيف الكود
  - ✅ **التأكد من صحة البيانات**:
    - تأكيد عمل جميع API endpoints بشكل مثالي
    - فحص البيانات الحقيقية في قاعدة البيانات (11 أغسطس 2025)
    - التأكد من عرض البيانات بالتواريخ الصحيحة
- **المرحلة الحالية**: المرحلة الأولى مُكتملة مع ملفات جاهزة للتطبيق الفوري + المرحلة الثانية محضرة ومُخططة
  - **المنجز**: تنظيف dependencies (8 حزم محذوفة) + أرشفة أصول + توثيق شامل
  - **الجاهز للتطبيق**: 6 ملفات كاملة (APPLY_COMMANDS.md، PR_TEMPLATE.md، إلخ)
  - **المرحلة التالية**: إصلاح 24 خطأ TypeScript + مراجعة حزم مشتبه بها

## التحسينات المخطط لها
### الأولوية الفورية (خطة تفصيلية في ROADMAP.md)
- تنظيف الحزم غير المستخدمة (3 حزم جاهزة للحذف)
- إصلاح 24 خطأ TypeScript المتبقي
- تفعيل CI/CD التلقائي
- أرشفة الأصول غير المستخدمة

### الأولوية طويلة المدى
- تحسين واجهة المستخدم للهاتف المحمول
- إضافة المزيد من أنواع التقارير
- تحسين نظام الإشعارات
- إضافة ميزات النسخ الاحتياطي التلقائي

## ملاحظات التطوير
- استخدام Supabase PostgreSQL فقط (ممنوع استخدام قاعدة البيانات المحلية)
- جميع النصوص والرسائل بالعربية
- دعم RTL في جميع أجزاء التطبيق
- اتباع معايير Material Design