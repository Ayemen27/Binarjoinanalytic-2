# قائمة مراجعة القالب الموحد - PR Checklist

## ✅ تم إنجازه تلقائياً

### 1. القوالب والمخططات
- [x] إنشاء قالب HTML موحد A4 في `client/public/templates/report_base.html`
- [x] إنشاء مخطط JSON للتقارير في `client/public/templates/report_schema.json`
- [x] تطبيق هوامش 10mm ودعم RTL
- [x] تصميم رأس وتذييل احترافي

### 2. تحديث المكونات
- [x] تحديث `UnifiedReportRenderer.tsx` لاستخدام القالب الموحد
- [x] إضافة تحميل القالب من `/templates/report_base.html`
- [x] إضافة دالة تحويل المحتوى إلى HTML
- [x] إضافة معالجة أخطاء مع قالب احتياطي

### 3. تحسين Excel
- [x] تحديث `UnifiedExcelExporter.tsx` لقراءة المخطط
- [x] تطبيق إعدادات A4 المحسنة
- [x] تحسين دعم RTL والهوامش

### 4. أدوات PDF
- [x] تثبيت Puppeteer بنجاح
- [x] إنشاء مولد PDF في `client/src/utils/pdfGenerator.ts`
- [x] إنشاء سكريبت اختبار PDF

### 5. النسخ الاحتياطية والسجلات
- [x] نسخ احتياطي شامل في `backups/unified-20250813_214345/`
- [x] سجل مفصل في `reports/unified-run.log`
- [x] توثيق جميع التغييرات

## ⚠️ يتطلب مراجعة يدوية

### 1. مراجعة فنية
- [ ] **اختبار القالب في المتصفح**: فتح صفحة التقارير والتأكد من العرض الصحيح
- [ ] **اختبار Print Preview**: التأكد من ظهور التقرير بشكل صحيح في معاينة الطباعة
- [ ] **اختبار تصدير PDF**: تجربة حفظ التقرير كـ PDF من المتصفح
- [ ] **اختبار Excel**: تجربة تصدير البيانات إلى Excel والتأكد من الترتيب

### 2. مراجعة أمنية
- [ ] **مراجعة dangerouslySetInnerHTML**: التأكد من عدم وجود مخاطر XSS
- [ ] **مراجعة fetch calls**: التأكد من صحة مسارات الـ API
- [ ] **مراجعة التحذيرات الأمنية**: حل 11 تحذير في Puppeteer بـ `npm audit fix`

### 3. مراجعة UX
- [ ] **اختبار الاستجابة**: التأكد من عمل التقارير على الهواتف
- [ ] **اختبار سرعة التحميل**: قياس وقت تحميل القوالب
- [ ] **اختبار تجربة المستخدم**: التأكد من سهولة الاستخدام

## 🚨 عمليات مطلوبة يدوياً

### 1. عمليات Git
```bash
# إنشاء فرع جديد
git checkout -b reports/unified-template

# إضافة الملفات
git add .

# إجراء commit
git commit -m "feat: إضافة قوالب التقارير الموحدة A4
- إنشاء قالب HTML موحد مع دعم RTL  
- إضافة مخطط JSON للتقارير
- تحسين إعدادات Excel و PDF
- تثبيت Puppeteer لتوليد PDF"

# رفع الفرع
git push origin reports/unified-template
```

### 2. تحديث التبعيات
```bash
# حل التحذيرات الأمنية
npm audit fix

# تحديث قاعدة البيانات
npx update-browserslist-db@latest
```

## 📋 اختبارات يدوية مطلوبة

### تقرير كشف حساب العامل
- [ ] فتح صفحة التقارير
- [ ] اختيار عامل واختيار فترة زمنية
- [ ] مراجعة العرض في المتصفح: ✅ PASS / ❌ FAIL
- [ ] اختبار Print Preview: ✅ PASS / ❌ FAIL  
- [ ] تجربة "حفظ كـ PDF": ✅ PASS / ❌ FAIL
- [ ] تصدير Excel ومراجعة الملف: ✅ PASS / ❌ FAIL

### التقرير اليومي للمصاريف
- [ ] فتح صفحة التقارير
- [ ] اختيار تاريخ ومشروع
- [ ] مراجعة العرض في المتصفح: ✅ PASS / ❌ FAIL
- [ ] اختبار Print Preview: ✅ PASS / ❌ FAIL
- [ ] تجربة "حفظ كـ PDF": ✅ PASS / ❌ FAIL
- [ ] تصدير Excel ومراجعة الملف: ✅ PASS / ❌ FAIL

### ملخص المشروع
- [ ] فتح صفحة التقارير
- [ ] اختيار مشروع وفترة زمنية
- [ ] مراجعة العرض في المتصفح: ✅ PASS / ❌ FAIL
- [ ] اختبار Print Preview: ✅ PASS / ❌ FAIL
- [ ] تجربة "حفظ كـ PDF": ✅ PASS / ❌ FAIL
- [ ] تصدير Excel ومراجعة الملف: ✅ PASS / ❌ FAIL

## 📊 معايير النجاح

### العرض في المتصفح
- ✅ رأس التقرير يظهر بشكل صحيح مع الشعار
- ✅ الجداول منسقة ومقروءة
- ✅ الألوان والخطوط متسقة
- ✅ لا يوجد عناصر خارجة عن الحدود

### معاينة الطباعة
- ✅ حجم الورق A4 محدد تلقائياً
- ✅ الهوامش 10mm من جميع الجهات
- ✅ لا يوجد قص في النصوص أو الجداول
- ✅ التذييل يظهر في الصفحة الأخيرة

### تصدير PDF
- ✅ الملف يفتح بشكل صحيح
- ✅ النص العربي يظهر بوضوح
- ✅ الجداول منسقة
- ✅ حجم الملف معقول (<500KB للتقرير العادي)

### تصدير Excel
- ✅ الأعمدة بالترتيب الصحيح حسب المخطط
- ✅ البيانات الرقمية في تنسيق العملة
- ✅ التواريخ بالتنسيق العربي
- ✅ RTL يعمل في Excel (أو قابل للضبط)

## 🔗 روابط مفيدة

- **ملف اللوج المفصل**: `reports/unified-run.log`
- **النسخ الاحتياطية**: `backups/unified-20250813_214345/`
- **القالب الموحد**: `client/public/templates/report_base.html`
- **مخطط التقارير**: `client/public/templates/report_schema.json`
- **سكريبت اختبار PDF**: `reports/test-pdf-generation.js`

---

**تم إنشاء هذه القائمة تلقائياً - 13 أغسطس 2025**  
**للمراجعة والاعتماد قبل الدمج في main**