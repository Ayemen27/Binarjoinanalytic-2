/* 
 * إصلاح مشكلة الأرقام الكبيرة عند الطباعة في Excel و PDF
 * يحل مشكلة ظهور أرقام مثل "١٤٢٤٥" بحجم كبير في وسط الصفحة
 * تم إنشاؤه خصيصاً لإصلاح إعدادات التكبير والمقياس
 */

/* إعدادات عامة لمنع ظهور الأرقام الكبيرة */
@media print {
  /* تثبيت إعدادات الصفحة الأساسية */
  @page {
    size: A4 portrait;
    margin: 0.5cm;
    zoom: 100% !important;
    scale: 1.0 !important;
  }

  /* تثبيت إعدادات الجسم الأساسية */
  body, html {
    zoom: 100% !important;
    transform: scale(1.0) !important;
    transform-origin: top right !important;
    font-size: 14px !important;
    line-height: 1.2 !important;
  }

  /* إصلاح شامل لجميع العناصر المحتوية على أرقام */
  * {
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
    max-font-size: 24px !important;
  }

  /* إصلاح خاص للأرقام والعملات */
  .currency, .amount, .number, .price,
  [class*="currency"], [class*="amount"], [class*="number"], [class*="price"],
  [style*="fontSize"], [style*="fontWeight"],
  td[style*="fontSize"], th[style*="fontSize"],
  span[style*="fontSize"], div[style*="fontSize"] {
    font-size: 12px !important;
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
    line-height: 1.2 !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    max-width: 100% !important;
    text-align: center !important;
    vertical-align: middle !important;
  }

  /* إصلاح خاص للجداول */
  table {
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
    font-size: 12px !important;
    table-layout: fixed !important;
    width: 100% !important;
  }

  /* إصلاح خاص لخلايا الجداول */
  td, th {
    font-size: 11px !important;
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
    padding: 4px 6px !important;
    line-height: 1.1 !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    vertical-align: middle !important;
    text-align: center !important;
  }

  /* إصلاح خاص للنصوص المتحركة أو المكبرة */
  .text-lg, .text-xl, .text-2xl, .text-3xl, .text-4xl, .text-5xl {
    font-size: 14px !important;
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
  }

  /* إصلاح خاص للعناوين الكبيرة */
  h1, h2, h3, h4, h5, h6 {
    font-size: 16px !important;
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
    line-height: 1.2 !important;
  }

  /* إصلاح للنصوص العريضة */
  strong, b, .font-bold, [style*="font-weight: bold"], [style*="fontWeight"] {
    font-size: 12px !important;
    font-weight: bold !important;
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
  }

  /* إصلاح خاص للأرقام في الخلايا المدمجة */
  td[colspan], th[colspan] {
    font-size: 11px !important;
    text-align: center !important;
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
  }

  /* إصلاح لمحتوى تقارير Excel المصدرة */
  .excel-export-content,
  #professional-daily-report,
  #enhanced-worker-account-statement,
  .enhanced-worker-account-report {
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
    font-size: 14px !important;
  }

  /* إصلاح لمنع التداخل في وسط الصفحة */
  .center-overlay, .middle-overlay, .floating-number {
    display: none !important;
    visibility: hidden !important;
  }

  /* إصلاح لضمان عدم ظهور أرقام عائمة */
  .floating, .absolute, .fixed {
    position: static !important;
    transform: none !important;
    zoom: 1.0 !important;
  }

  /* إصلاح للنصوص المتوسطة */
  .text-center {
    text-align: center !important;
    font-size: 12px !important;
    zoom: 1.0 !important;
  }

  /* إصلاح خاص للأرقام العربية */
  .arabic-number, .arabic-currency, .arabic-amount {
    font-size: 12px !important;
    font-family: 'Arial', 'Tahoma', sans-serif !important;
    direction: ltr !important;
    unicode-bidi: embed !important;
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
  }

  /* إصلاح للمحتوى المتدفق */
  .overflow-auto, .overflow-hidden, .overflow-visible {
    overflow: hidden !important;
    zoom: 1.0 !important;
  }

  /* إصلاح نهائي شامل */
  * {
    -webkit-transform: scale(1.0) !important;
    -moz-transform: scale(1.0) !important;
    -ms-transform: scale(1.0) !important;
    -o-transform: scale(1.0) !important;
    -webkit-zoom: 1.0 !important;
    -moz-zoom: 1.0 !important;
    zoom: 1.0 !important;
    max-font-size: 20px !important;
  }
}

/* إضافة إعدادات للعرض العادي أيضاً */
@media screen {
  /* منع ظهور الأرقام الكبيرة حتى في العرض العادي */
  .prevent-large-numbers,
  .currency, .amount, .number, .price {
    zoom: 1.0 !important;
    transform: scale(1.0) !important;
    max-font-size: 24px !important;
  }
}