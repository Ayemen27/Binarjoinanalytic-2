/* Worker Account Report - Enhanced Print Styles */
@media print {
  /* إخفاء كل شيء عدا تقرير كشف حساب العمال */
  * {
    visibility: hidden !important;
  }

  #professional-worker-account-report, 
  #professional-worker-account-report * {
    visibility: visible !important;
  }

  /* تحسين إعدادات الصفحة للاستفادة الكاملة من المساحة */
  @page {
    size: A4 !important;
    margin: 0.5cm !important; /* هوامش صغيرة جداً */
    padding: 0 !important;
  }

  html, body {
    margin: 0 !important;
    padding: 0 !important;
    background: white !important;
    font-family: 'Arial', 'Times New Roman', serif !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
    font-size: 12px !important;
    line-height: 1.2 !important;
  }

  #professional-worker-account-report {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 !important;
    padding: 0.3cm !important; /* تباعد داخلي صغير */
    background: white !important;
    font-size: 13px !important;
    line-height: 1.3 !important;
    overflow: visible !important;
    page-break-inside: avoid !important;
  }

  /* تحسين العنوان الرئيسي */
  .enhanced-header {
    margin: 0 0 0.4cm 0 !important;
    padding: 0.3cm 0 !important;
    border: 2px solid #7c3aed !important;
    border-radius: 6px !important;
  }

  .enhanced-header h1 {
    font-size: 24px !important;
    font-weight: bold !important;
    margin: 0.2cm 0 !important;
    color: #7c3aed !important;
    text-align: center !important;
  }

  /* تحسين بيانات العامل والملخص المالي */
  .enhanced-header > div {
    padding: 0 0.5cm !important;
  }

  .worker-info-badge, .report-badge {
    width: 80px !important;
    height: 70px !important;
    border-radius: 8px !important;
    font-size: 11px !important;
  }

  /* تحسين لوحات المعلومات */
  .enhanced-worker-account-report > div:nth-child(2) {
    margin-bottom: 0.4cm !important;
    gap: 0.4cm !important;
  }

  .enhanced-worker-account-report > div:nth-child(2) > div {
    padding: 0.4cm !important;
    border-radius: 6px !important;
    border: 1px solid #ccc !important;
  }

  .enhanced-worker-account-report > div:nth-child(2) h3 {
    font-size: 16px !important;
    margin-bottom: 0.3cm !important;
    font-weight: bold !important;
  }

  .enhanced-worker-account-report > div:nth-child(2) div[style*="grid"] {
    font-size: 14px !important;
    gap: 0.2cm !important;
  }

  /* تحسين الجداول */
  .enhanced-summary-table {
    width: 100% !important;
    border-collapse: collapse !important;
    margin: 0 0 0.4cm 0 !important;
    font-size: 12px !important;
    line-height: 1.2 !important;
    border: 2px solid #1e40af !important;
  }

  .enhanced-summary-table th {
    padding: 0.3cm 0.2cm !important;
    font-size: 13px !important;
    font-weight: bold !important;
    border: 1px solid #1e3a8a !important;
    background: #1e40af !important;
    color: white !important;
    text-align: center !important;
    -webkit-print-color-adjust: exact !important;
    height: auto !important;
  }

  .enhanced-summary-table td {
    padding: 0.25cm 0.15cm !important;
    font-size: 12px !important;
    border: 1px solid #cbd5e1 !important;
    text-align: center !important;
    vertical-align: middle !important;
    line-height: 1.3 !important;
  }

  /* تحسين العناوين الجانبية */
  .enhanced-worker-account-report h2 {
    font-size: 18px !important;
    margin: 0.3cm 0 !important;
    padding: 0.25cm !important;
    border-radius: 6px !important;
    text-align: center !important;
    font-weight: bold !important;
  }

  /* تحسين الملخص النهائي */
  .enhanced-worker-account-report > div:last-child {
    margin-top: 0.4cm !important;
    padding: 0.4cm !important;
    border-radius: 8px !important;
    border: 2px solid #f59e0b !important;
  }

  .enhanced-worker-account-report > div:last-child h2 {
    font-size: 20px !important;
    margin-bottom: 0.3cm !important;
  }

  .enhanced-worker-account-report > div:last-child > div:first-of-type {
    gap: 0.3cm !important;
    font-size: 15px !important;
  }

  .enhanced-worker-account-report > div:last-child > div:first-of-type > div {
    padding: 0.3cm !important;
    border-radius: 6px !important;
    border: 1px solid #ccc !important;
  }

  .enhanced-worker-account-report > div:last-child > div:first-of-type > div > div:first-child {
    font-size: 13px !important;
    margin-bottom: 0.1cm !important;
  }

  .enhanced-worker-account-report > div:last-child > div:first-of-type > div > div:last-child {
    font-size: 18px !important;
    font-weight: bold !important;
  }

  /* تحسين الرصيد النهائي */
  .enhanced-worker-account-report > div:last-child > div:last-child {
    margin-top: 0.4cm !important;
    padding: 0.4cm !important;
    border-radius: 8px !important;
    border: 2px solid #10b981 !important;
    text-align: center !important;
  }

  .enhanced-worker-account-report > div:last-child > div:last-child > div:first-child {
    font-size: 16px !important;
    margin-bottom: 0.2cm !important;
  }

  .enhanced-worker-account-report > div:last-child > div:last-child > div:nth-child(2) {
    font-size: 26px !important;
    font-weight: bold !important;
  }

  .enhanced-worker-account-report > div:last-child > div:last-child > div:last-child {
    font-size: 12px !important;
    margin-top: 0.1cm !important;
  }

  /* تحسين التذييل */
  .enhanced-worker-account-report > div:nth-last-child(2) {
    margin-top: 0.5cm !important;
    padding: 0.2cm !important;
    border-top: 1px solid #9ca3af !important;
    font-size: 10px !important;
    text-align: center !important;
  }

  /* الحفاظ على الألوان */
  .preserve-color {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  .enhanced-header-row {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  /* تحسين استغلال المساحة للجداول الطويلة */
  .enhanced-summary-table tbody tr {
    page-break-inside: avoid !important;
  }

  /* منع فصل العناصر المهمة */
  .enhanced-header,
  .enhanced-worker-account-report > div:nth-child(2),
  .enhanced-worker-account-report > div:last-child {
    page-break-inside: avoid !important;
  }

  /* إزالة الظلال والتأثيرات غير الضرورية للطباعة */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
  }

  /* تحسين عرض التواريخ والأرقام */
  .enhanced-summary-table td[style*="color: #059669"],
  .enhanced-summary-table td[style*="color: #0d9488"],
  .enhanced-summary-table td[style*="color: #dc2626"] {
    font-weight: bold !important;
  }

  /* تحسين عرض معلومات الحوالات */
  .enhanced-summary-table td[style*="background: #fef2f2"],
  .enhanced-summary-table td[style*="background: #f0fdf4"],
  .enhanced-summary-table td[style*="background: #f0fdfa"] {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
  }

  /* تحسين الخطوط والأحجام للقراءة الأفضل */
  strong {
    font-weight: bold !important;
    color: #000 !important;
  }

  /* تحسين عرض الجداول ذات الصفوف المتعددة */
  .enhanced-summary-table tfoot tr {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-weight: bold !important;
  }

  .enhanced-summary-table tfoot td {
    font-size: 14px !important;
    font-weight: bold !important;
    padding: 0.3cm 0.2cm !important;
  }
}

/* أنماط الشاشة للمعاينة */
@media screen {
  #professional-worker-account-report {
    max-width: 21cm;
    min-height: 29.7cm;
    margin: 1cm auto;
    background: white;
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
    padding: 1cm;
  }
}